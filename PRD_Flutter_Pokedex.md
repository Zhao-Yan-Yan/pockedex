# 产品需求文档（PRD）

## Pokedex Flutter - 宝可梦图鉴应用

| 文档信息 |  |
|---------|--|
| 产品名称 | Pokedex Flutter |
| 版本 | v1.0.0 |
| 创建日期 | 2024-11-24 |
| 产品经理 | - |
| 开发平台 | Flutter (iOS & Android) |
| 状态 | 待开发 |

---

## 一、产品概述

### 1.1 产品背景

宝可梦（Pokémon）作为全球最受欢迎的 IP 之一，拥有庞大的粉丝群体。为了满足用户随时随地查阅宝可梦资料的需求，我们计划开发一款跨平台的宝可梦图鉴应用。

本项目基于已成功运营的 Android 原生应用（Pokedex Compose）进行 Flutter 跨平台重构，旨在以更低的开发成本覆盖 iOS 和 Android 双平台用户。

### 1.2 产品定位

一款**简洁、流畅、离线可用**的宝可梦图鉴工具应用，为宝可梦爱好者提供便捷的宝可梦信息查询服务。

### 1.3 目标用户

| 用户群体 | 特征描述 |
|---------|---------|
| 宝可梦游戏玩家 | 需要在游戏过程中快速查阅宝可梦属性、能力值等信息 |
| 宝可梦动画/电影爱好者 | 对宝可梦角色感兴趣，想了解更多信息 |
| 收藏爱好者 | 喜欢浏览和收集宝可梦资料 |

### 1.4 产品目标

| 指标 | 目标值 |
|-----|-------|
| 首次上线平台 | iOS + Android 同步上线 |
| 应用启动时间 | < 2 秒 |
| 列表滚动帧率 | ≥ 60 FPS |
| 离线可用性 | 100%（已缓存数据） |
| 应用包体积 | < 20 MB |

---

## 二、功能需求

### 2.1 功能架构图

```
┌─────────────────────────────────────────────────────┐
│                   Pokedex Flutter                   │
├─────────────────────────────────────────────────────┤
│                                                     │
│  ┌─────────────────┐      ┌─────────────────────┐  │
│  │                 │      │                     │  │
│  │    首页         │ ───→ │      详情页         │  │
│  │  (宝可梦列表)   │      │   (宝可梦详情)      │  │
│  │                 │      │                     │  │
│  └─────────────────┘      └─────────────────────┘  │
│                                                     │
├─────────────────────────────────────────────────────┤
│                    基础服务层                        │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐           │
│  │ 网络请求  │ │ 本地缓存  │ │ 图片加载  │           │
│  └──────────┘ └──────────┘ └──────────┘           │
└─────────────────────────────────────────────────────┘
```

### 2.2 功能清单

| 功能模块 | 功能点 | 优先级 | 状态 |
|---------|-------|-------|------|
| 首页 | 宝可梦列表展示 | P0 | 待开发 |
| 首页 | 分页加载 | P0 | 待开发 |
| 首页 | 下拉刷新 | P1 | 待开发 |
| 首页 | 图片主色调提取 | P1 | 待开发 |
| 详情页 | 基础信息展示 | P0 | 待开发 |
| 详情页 | 属性类型展示 | P0 | 待开发 |
| 详情页 | 能力值展示 | P0 | 待开发 |
| 详情页 | 能力值进度条动画 | P1 | 待开发 |
| 通用 | 页面转场动画 | P1 | 待开发 |
| 通用 | 离线缓存 | P0 | 待开发 |
| 通用 | 错误处理与提示 | P0 | 待开发 |
| 通用 | 加载状态展示 | P0 | 待开发 |

---

## 三、详细功能说明

### 3.1 首页 - 宝可梦列表

#### 3.1.1 功能描述

展示宝可梦列表，用户可浏览所有宝可梦并点击进入详情页。

#### 3.1.2 界面布局

```
┌──────────────────────────────────────┐
│           Pokedex（标题栏）           │
├──────────────────────────────────────┤
│                                      │
│  ┌────────────┐  ┌────────────┐     │
│  │            │  │            │     │
│  │   [图片]   │  │   [图片]   │     │
│  │            │  │            │     │
│  │  Bulbasaur │  │  Ivysaur   │     │
│  └────────────┘  └────────────┘     │
│                                      │
│  ┌────────────┐  ┌────────────┐     │
│  │            │  │            │     │
│  │   [图片]   │  │   [图片]   │     │
│  │            │  │            │     │
│  │  Venusaur  │  │ Charmander │     │
│  └────────────┘  └────────────┘     │
│                                      │
│            ... 无限滚动 ...          │
│                                      │
└──────────────────────────────────────┘
```

#### 3.1.3 功能规格

| 项目 | 规格说明 |
|-----|---------|
| 布局方式 | 2 列网格布局（Grid） |
| 卡片尺寸 | 宽度自适应，高度根据内容自动计算 |
| 图片尺寸 | 120 × 120 dp |
| 卡片圆角 | 14 dp |
| 卡片背景色 | 从宝可梦图片中提取主色调 |
| 分页大小 | 每页 20 条 |
| 预加载阈值 | 距离底部 8 条时触发下一页加载 |
| 图片来源 | PokeAPI 官方高清图（Official Artwork） |

#### 3.1.4 交互说明

| 操作 | 响应 |
|-----|------|
| 点击卡片 | 跳转至宝可梦详情页，触发共享元素动画 |
| 滚动到底部 | 自动加载下一页数据 |
| 网络异常 | 显示错误提示，提供重试按钮 |
| 首次加载 | 显示骨架屏或加载指示器 |

#### 3.1.5 卡片信息展示

| 字段 | 说明 | 示例 |
|-----|------|-----|
| 图片 | 宝可梦官方立绘 | ![bulbasaur] |
| 名称 | 宝可梦名称（首字母大写） | Bulbasaur |

---

### 3.2 详情页 - 宝可梦详情

#### 3.2.1 功能描述

展示单只宝可梦的详细信息，包括基础属性、类型和能力值。

#### 3.2.2 界面布局

```
┌──────────────────────────────────────┐
│  ←                          #001    │  ← 头部区域
│                                      │
│         B u l b a s a u r            │  ← 宝可梦名称
│                                      │
│              [大图]                   │  ← 宝可梦图片 (190×190)
│                                      │
├──────────────────────────────────────┤
│                                      │
│     ┌───────┐  ┌────────┐           │  ← 属性标签
│     │ Grass │  │ Poison │           │
│     └───────┘  └────────┘           │
│                                      │
│   身高: 0.7 M      体重: 6.9 KG      │  ← 基础信息
│                                      │
├──────────────────────────────────────┤
│                                      │
│  HP      ████████░░░░░░  45/300     │  ← 能力值
│  ATK     ██████░░░░░░░░  49/300     │
│  DEF     ██████░░░░░░░░  49/300     │
│  SPD     ██████░░░░░░░░  45/300     │
│  EXP     ████████████░░  64/1000    │
│                                      │
└──────────────────────────────────────┘
```

#### 3.2.3 功能规格

**头部区域**

| 项目 | 规格说明 |
|-----|---------|
| 区域高度 | 290 dp |
| 背景色 | 从宝可梦图片提取的主色调 |
| 返回按钮 | 左上角，点击返回上一页 |
| 编号 | 右上角，格式为 #XXX（三位数字，不足补零） |
| 名称 | 居中显示，首字母大写 |
| 图片尺寸 | 190 × 190 dp |

**属性类型**

| 项目 | 规格说明 |
|-----|---------|
| 展示方式 | 圆角胶囊标签 |
| 背景色 | 根据属性类型显示对应颜色 |
| 最多数量 | 2 个（主属性 + 副属性） |

**属性颜色映射表**

| 属性 | 英文名 | 颜色值（建议） |
|-----|-------|--------------|
| 格斗 | Fighting | #C22E28 |
| 飞行 | Flying | #A98FF3 |
| 毒 | Poison | #A33EA1 |
| 地面 | Ground | #E2BF65 |
| 岩石 | Rock | #B6A136 |
| 虫 | Bug | #A6B91A |
| 幽灵 | Ghost | #735797 |
| 钢 | Steel | #B7B7CE |
| 火 | Fire | #EE8130 |
| 水 | Water | #6390F0 |
| 草 | Grass | #7AC74C |
| 电 | Electric | #F7D02C |
| 超能力 | Psychic | #F95587 |
| 冰 | Ice | #96D9D6 |
| 龙 | Dragon | #6F35FC |
| 恶 | Dark | #705746 |
| 妖精 | Fairy | #D685AD |

**基础信息**

| 字段 | 数据格式 | 示例 |
|-----|---------|-----|
| 身高 | X.X M（原始值 ÷ 10） | 0.7 M |
| 体重 | X.X KG（原始值 ÷ 10） | 6.9 KG |

**能力值（Stats）**

| 能力 | 英文名 | 最大值 |
|-----|-------|-------|
| 生命值 | HP | 300 |
| 攻击 | ATK | 300 |
| 防御 | DEF | 300 |
| 速度 | SPD | 300 |
| 经验值 | EXP | 1000 |

#### 3.2.4 交互说明

| 操作 | 响应 |
|-----|------|
| 点击返回按钮 | 返回首页，触发共享元素动画 |
| 页面加载 | 能力值进度条播放填充动画（950ms） |
| 加载中 | 显示加载指示器 |
| 加载失败 | 显示错误信息和重试按钮 |

#### 3.2.5 进度条动画规格

| 项目 | 规格说明 |
|-----|---------|
| 动画时长 | 950 毫秒 |
| 缓动函数 | ease-out（快进慢出） |
| 数值显示 | 当前值/最大值（如 45/300） |
| 文本位置 | 进度条内（空间足够时）或进度条外（空间不足时） |

---

### 3.3 通用功能

#### 3.3.1 页面转场动画

| 动画类型 | 说明 |
|---------|-----|
| 共享元素 | 宝可梦图片从卡片位置平滑过渡到详情页位置 |
| 共享元素 | 宝可梦名称从卡片位置平滑过渡到详情页位置 |
| 动画时长 | 550 毫秒 |
| 缓动曲线 | 中低刚度弹簧动画 |

#### 3.3.2 离线缓存策略

```
┌─────────────────────────────────────────────────────┐
│                    数据请求流程                      │
├─────────────────────────────────────────────────────┤
│                                                     │
│  请求数据 → 查询本地缓存 ─┬→ 有缓存 → 返回缓存数据   │
│                          │                         │
│                          └→ 无缓存 → 请求网络 ─┬→ 成功 → 存储缓存 → 返回数据
│                                               │
│                                               └→ 失败 → 显示错误
│                                                     │
└─────────────────────────────────────────────────────┘
```

**缓存规则**

| 数据类型 | 缓存策略 | 存储位置 |
|---------|---------|---------|
| 宝可梦列表 | 按页缓存，永久有效 | SQLite 数据库 |
| 宝可梦详情 | 按名称缓存，永久有效 | SQLite 数据库 |
| 宝可梦图片 | 磁盘缓存 | 应用缓存目录 |

#### 3.3.3 错误处理

| 错误类型 | 处理方式 |
|---------|---------|
| 网络连接失败 | 显示"网络连接失败，请检查网络设置"，提供重试按钮 |
| 服务器错误 | 显示"服务器开小差了，请稍后重试"，提供重试按钮 |
| 数据解析错误 | 显示"数据加载失败"，记录错误日志 |
| 请求超时 | 显示"请求超时，请重试"，提供重试按钮 |

#### 3.3.4 加载状态

| 场景 | 展示方式 |
|-----|---------|
| 首页初次加载 | 全屏加载指示器或骨架屏 |
| 首页分页加载 | 列表底部显示加载指示器 |
| 详情页加载 | 内容区域显示加载指示器 |

---

## 四、数据接口

### 4.1 数据源

| 项目 | 说明 |
|-----|------|
| API 提供方 | PokeAPI |
| 基础 URL | https://pokeapi.co/api/v2/ |
| 协议 | HTTPS |
| 数据格式 | JSON |
| 认证方式 | 无需认证（公开 API） |

### 4.2 接口列表

#### 4.2.1 获取宝可梦列表

```
GET /pokemon?limit={limit}&offset={offset}
```

**请求参数**

| 参数 | 类型 | 必填 | 说明 | 默认值 |
|-----|------|-----|------|-------|
| limit | int | 否 | 每页数量 | 20 |
| offset | int | 否 | 偏移量 | 0 |

**响应示例**

```json
{
  "count": 1302,
  "next": "https://pokeapi.co/api/v2/pokemon?offset=20&limit=20",
  "previous": null,
  "results": [
    {
      "name": "bulbasaur",
      "url": "https://pokeapi.co/api/v2/pokemon/1/"
    },
    {
      "name": "ivysaur",
      "url": "https://pokeapi.co/api/v2/pokemon/2/"
    }
  ]
}
```

**字段说明**

| 字段 | 类型 | 说明 |
|-----|------|------|
| count | int | 宝可梦总数 |
| next | string? | 下一页 URL，无下一页时为 null |
| previous | string? | 上一页 URL |
| results | array | 宝可梦列表 |
| results[].name | string | 宝可梦名称（小写） |
| results[].url | string | 宝可梦详情 URL |

#### 4.2.2 获取宝可梦详情

```
GET /pokemon/{name}
```

**请求参数**

| 参数 | 类型 | 必填 | 说明 |
|-----|------|-----|------|
| name | string | 是 | 宝可梦名称（小写）或 ID |

**响应示例**

```json
{
  "id": 1,
  "name": "bulbasaur",
  "height": 7,
  "weight": 69,
  "base_experience": 64,
  "types": [
    {
      "slot": 1,
      "type": {
        "name": "grass"
      }
    },
    {
      "slot": 2,
      "type": {
        "name": "poison"
      }
    }
  ],
  "stats": [
    {
      "base_stat": 45,
      "effort": 0,
      "stat": {
        "name": "hp"
      }
    },
    {
      "base_stat": 49,
      "effort": 0,
      "stat": {
        "name": "attack"
      }
    },
    {
      "base_stat": 49,
      "effort": 0,
      "stat": {
        "name": "defense"
      }
    },
    {
      "base_stat": 45,
      "effort": 0,
      "stat": {
        "name": "speed"
      }
    }
  ]
}
```

**字段说明**

| 字段 | 类型 | 说明 |
|-----|------|------|
| id | int | 图鉴编号 |
| name | string | 名称 |
| height | int | 身高（单位：分米） |
| weight | int | 体重（单位：百克） |
| base_experience | int | 基础经验值 |
| types | array | 属性类型列表 |
| types[].slot | int | 属性槽位（1=主属性，2=副属性） |
| types[].type.name | string | 属性名称 |
| stats | array | 能力值列表 |
| stats[].base_stat | int | 基础能力值 |
| stats[].stat.name | string | 能力名称（hp/attack/defense/speed 等） |

### 4.3 图片资源

**宝可梦官方立绘**

```
https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/{id}.png
```

| 参数 | 说明 | 示例 |
|-----|------|------|
| id | 宝可梦图鉴编号 | 1, 25, 150 |

**示例**

- Bulbasaur: `https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/1.png`
- Pikachu: `https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/25.png`

---

## 五、数据模型

### 5.1 本地数据模型

#### Pokemon（宝可梦基础信息）

| 字段 | 类型 | 说明 |
|-----|------|------|
| page | int | 所属页码（本地字段） |
| name | string | 名称（小写） |
| url | string | 详情 API 地址 |

**计算属性**

| 属性 | 类型 | 说明 |
|-----|------|------|
| displayName | string | 显示名称（首字母大写） |
| imageUrl | string | 官方立绘 URL（从 url 中提取 ID 拼接） |
| id | int | 图鉴编号（从 url 中提取） |

#### PokemonInfo（宝可梦详细信息）

| 字段 | 类型 | 说明 |
|-----|------|------|
| id | int | 图鉴编号 |
| name | string | 名称 |
| height | int | 身高（分米） |
| weight | int | 体重（百克） |
| experience | int | 基础经验值 |
| types | List<PokemonType> | 属性类型列表 |
| stats | List<PokemonStat> | 能力值列表 |

**计算属性**

| 属性 | 类型 | 说明 |
|-----|------|------|
| idString | string | 格式化编号（#001） |
| heightString | string | 格式化身高（0.7 M） |
| weightString | string | 格式化体重（6.9 KG） |
| hp | int | 生命值 |
| attack | int | 攻击力 |
| defense | int | 防御力 |
| speed | int | 速度 |

---

## 六、非功能需求

### 6.1 性能要求

| 指标 | 要求 |
|-----|------|
| 应用冷启动时间 | ≤ 2 秒 |
| 列表滚动帧率 | ≥ 60 FPS |
| 页面切换时间 | ≤ 300 毫秒 |
| 图片加载时间 | ≤ 3 秒（首次），≤ 100 毫秒（缓存） |
| 内存占用 | ≤ 150 MB |

### 6.2 兼容性要求

| 平台 | 最低版本 |
|-----|---------|
| iOS | 12.0 |
| Android | API 21 (Android 5.0) |
| Flutter SDK | 3.16.0+ |

### 6.3 安全要求

| 项目 | 说明 |
|-----|------|
| 网络通信 | 强制使用 HTTPS |
| 数据存储 | 本地数据库无敏感信息，无需加密 |
| 权限申请 | 仅申请必要权限（网络访问） |

### 6.4 可用性要求

| 项目 | 说明 |
|-----|------|
| 离线使用 | 支持查看已缓存的宝可梦数据 |
| 错误恢复 | 网络恢复后自动重试或提供手动重试 |
| 无障碍 | 支持屏幕阅读器，提供语义化标签 |

---

## 七、设计规范

### 7.1 主题色

| 用途 | 颜色值 | 说明 |
|-----|-------|------|
| 主色调 | 动态提取 | 从宝可梦图片中提取 |
| 背景色 | #FFFFFF（亮色）/ #121212（暗色） | 支持深色模式 |
| 文字主色 | #212121（亮色）/ #FFFFFF（暗色） | |
| 文字次要色 | #757575 | |

### 7.2 字体规范

| 用途 | 字号 | 字重 |
|-----|------|-----|
| 页面标题 | 24 sp | Bold |
| 宝可梦名称（详情） | 30 sp | Bold |
| 宝可梦名称（卡片） | 16 sp | Medium |
| 编号 | 18 sp | Medium |
| 正文 | 14 sp | Regular |
| 属性标签 | 14 sp | Medium |

### 7.3 间距规范

| 用途 | 数值 |
|-----|------|
| 页面边距 | 16 dp |
| 卡片间距 | 8 dp |
| 卡片内边距 | 12 dp |
| 元素间距（小） | 4 dp |
| 元素间距（中） | 8 dp |
| 元素间距（大） | 16 dp |

---

## 八、里程碑规划

### Phase 1：MVP 版本

**目标**：实现核心功能，验证技术可行性

| 功能 | 优先级 |
|-----|-------|
| 项目架构搭建 | P0 |
| 网络层实现 | P0 |
| 数据库层实现 | P0 |
| 首页列表展示 | P0 |
| 分页加载 | P0 |
| 详情页基础信息 | P0 |
| 离线缓存 | P0 |

### Phase 2：体验优化

**目标**：提升用户体验，完善交互细节

| 功能 | 优先级 |
|-----|-------|
| 共享元素动画 | P1 |
| 进度条动画 | P1 |
| 图片主色调提取 | P1 |
| 骨架屏加载 | P1 |
| 深色模式支持 | P1 |

### Phase 3：功能扩展（Future）

**目标**：根据用户反馈扩展功能

| 功能 | 优先级 |
|-----|-------|
| 搜索功能 | P2 |
| 收藏功能 | P2 |
| 属性筛选 | P2 |
| 多语言支持 | P2 |
| 宝可梦进化链 | P2 |

---

## 九、验收标准

### 9.1 功能验收

| 验收项 | 验收标准 |
|-------|---------|
| 首页列表 | 能正常展示宝可梦列表，图片和名称显示正确 |
| 分页加载 | 滚动到底部自动加载下一页，无重复数据 |
| 详情展示 | 点击卡片进入详情页，所有信息展示正确 |
| 属性颜色 | 各属性类型显示对应颜色 |
| 能力值 | 进度条数值与 API 返回一致 |
| 离线缓存 | 断网后能查看已加载的数据 |
| 错误处理 | 网络异常时显示友好提示 |

### 9.2 性能验收

| 验收项 | 验收标准 |
|-------|---------|
| 启动时间 | 冷启动 ≤ 2 秒 |
| 列表流畅度 | 快速滚动无卡顿，帧率 ≥ 60 FPS |
| 页面切换 | 动画流畅，无闪烁 |

### 9.3 兼容性验收

| 验收项 | 验收标准 |
|-------|---------|
| iOS 设备 | iPhone SE ~ iPhone 15 Pro Max 正常运行 |
| Android 设备 | 主流品牌（华为、小米、OPPO、vivo、三星）正常运行 |
| 屏幕适配 | 支持各种屏幕尺寸，无布局错乱 |

---

## 十、附录

### 10.1 术语表

| 术语 | 说明 |
|-----|------|
| 宝可梦 | Pokémon，神奇宝贝/精灵宝可梦的官方中文译名 |
| 图鉴 | Pokédex，记录宝可梦信息的百科工具 |
| 属性 | Type，宝可梦的元素类型，影响战斗相克关系 |
| 能力值 | Stats，包括 HP、攻击、防御、速度等数值 |

### 10.2 参考资料

| 资料 | 链接 |
|-----|------|
| PokeAPI 官方文档 | https://pokeapi.co/docs/v2 |
| 原 Android 项目 | https://github.com/skydoves/pokedex-compose |
| Flutter 官方文档 | https://docs.flutter.dev |
| Material Design 3 | https://m3.material.io |

### 10.3 修订记录

| 版本 | 日期 | 修订内容 | 修订人 |
|-----|------|---------|-------|
| 1.0.0 | 2024-11-24 | 初始版本 | - |

---

**文档结束**